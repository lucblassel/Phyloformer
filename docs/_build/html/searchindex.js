Search.setIndex({"docnames": ["index", "modules", "phyloformer", "phyloformer.scripts", "readme"], "filenames": ["index.rst", "modules.rst", "phyloformer.rst", "phyloformer.scripts.rst", "readme.rst"], "titles": ["Welcome to Phyloformer\u2019s documentation!", "API reference", "phyloformer package", "phyloformer.scripts package", "Introduction to Phyloformer"], "terms": {"introduct": 0, "toward": 0, "fast": 0, "accur": 0, "phylogeni": 0, "estim": 0, "self": 0, "attent": [0, 1], "network": [0, 2], "instal": 0, "usag": 0, "simul": [0, 2], "train": [0, 1], "reproduc": 0, "result": 0, "paper": 0, "disclaim": 0, "api": 0, "refer": 0, "packag": [0, 1, 4], "subpackag": [], "submodul": [0, 1], "modul": [0, 1], "data": [0, 1], "pretrain": [0, 1], "index": 0, "search": 0, "page": 0, "phyloform": 1, "script": [2, 4], "evalu": [], "make_tensor": [2, 4], "predict": 4, "simulatealign": 4, "simulatetre": 4, "content": [1, 4], "kernelaxialmultiattent": [1, 2], "forward": [1, 2], "tensordataset": [1, 2], "load_align": [1, 2], "load_dataset": [1, 2], "write_dm": [1, 2], "attentionnet": [1, 2, 3], "infer_dm": [1, 2], "infer_tre": [1, 2], "save": [1, 2, 4], "load_model": [1, 2], "load_state_dict": [1, 2], "evosimz": [1, 2, 4], "seqgen": [1, 2], "init_train": [1, 2], "load_checkpoint": [1, 2], "training_loop": [1, 2], "main": 3, "ali_pars": [], "to_arrai": [], "tree_dist": [], "is_fasta": 3, "make_predict": 3, "simulate_align": 3, "simulate_tre": 3, "mre": [], "strip": [], "kfold": [], "The": [2, 4], "contain": [2, 4], "class": 2, "multiheadattent": 2, "h_dim": 2, "n_head": 2, "dropout": 2, "0": [2, 4], "ep": 2, "1e": 2, "06": [2, 4], "n": [2, 4], "none": [2, 3], "k": 2, "sourc": [2, 3, 4], "base": [2, 4], "x": 2, "defin": 2, "comput": 2, "perform": [2, 4], "everi": 2, "call": 2, "should": [2, 4], "overridden": 2, "all": 2, "subclass": 2, "although": 2, "recip": 2, "pass": 2, "need": [2, 4], "within": 2, "thi": [2, 4], "function": [2, 4], "one": [2, 4], "instanc": 2, "afterward": 2, "instead": 2, "sinc": 2, "former": 2, "take": 2, "care": 2, "run": 2, "regist": 2, "hook": 2, "while": 2, "latter": 2, "silent": 2, "ignor": 2, "them": [2, 4], "bool": [2, 3], "ar": [2, 4], "us": [2, 4], "load": [2, 4], "align": 2, "format": [2, 4], "understand": 2, "directori": [2, 4], "str": [2, 3], "dataset": 2, "path": [2, 3, 4], "tupl": 2, "tensor": 2, "list": 2, "an": [2, 4], "digest": 2, "paramet": [2, 4], "fasta": [2, 4], "file": [2, 4], "return": 2, "repres": 2, "shape": 2, "22": 2, "seq_len": 2, "nb_seq": [], "id": 2, "sequenc": [2, 4], "type": [2, 4], "torch": 2, "dm": 2, "distancematrix": 2, "write": [2, 4], "distanc": [2, 4], "matrix": 2, "disk": 2, "squar": 2, "phylip": 2, "skbio": 2, "where": [2, 4], "well": 2, "creat": 2, "from": [2, 4], "n_block": 2, "int": 2, "1": [2, 4], "4": [2, 4], "64": 2, "float": 2, "devic": 2, "cpu": 2, "n_seq": 2, "20": [2, 4], "200": [2, 4], "kwarg": 2, "do": [2, 4], "through": [2, 4], "input": [2, 4], "output": [2, 4], "n_pair": 2, "rais": 2, "valueerror": 2, "If": [2, 4], "aren": 2, "t": 2, "right": 2, "infer": [2, 4], "phylogenet": [2, 4], "embed": 2, "option": [2, 4], "identifi": [2, 3], "default": [2, 4], "phylolgenet": 2, "treenod": 2, "tree": 2, "precomput": 2, "you": 2, "have": [2, 4], "alreadi": 2, "your": 2, "own": 2, "neighbour": 2, "join": 2, "model": [2, 3], "single_gpu": 2, "true": [2, 3, 4], "istanc": 2, "wether": 2, "fine": 2, "tune": 2, "done": 2, "singl": 2, "gpu": [2, 4], "doe": 2, "state_dict": 2, "architectur": 2, "model_path": 2, "6": 2, "pre": 2, "state": 2, "dict": 2, "user": [2, 4], "must": 2, "specifi": [2, 4], "": 2, "arrchitectur": 2, "themselv": 2, "For": [2, 4], "either": 2, "dictionnari": 2, "number": [2, 4], "block": 2, "hidden": 2, "dimens": 2, "head": 2, "per": 2, "length": [2, 4], "pytorch": 2, "drop": 2, "out": 2, "rate": 2, "A": 2, "readi": [2, 4], "traind": 2, "wa": 2, "seq": [2, 4], "gen": [2, 4], "necessari": 2, "optim": 2, "learn": 2, "shcedul": [], "config": 2, "schedul": 2, "continu": [], "interrupt": [], "given": [], "pred": 3, "tree_path": [], "ali_path": [], "out_dir": 3, "normal": 4, "fals": 2, "aln_dir": 3, "save_dm": 3, "in_dir": 3, "seq_gen_path": 3, "len_seq": 3, "numtre": 3, "numleav": 3, "outdir": 3, "treetyp": 3, "bl": [3, 4], "y": [], "string": [], "char": [], "fold": [], "l": 4, "train_load": [], "test_load": [], "num_epoch": [], "criterion": 2, "amp": 2, "hyperparamet": 4, "writer": [], "t_loss": [], "v_loss": [], "v_mae": [], "v_mre": [], "verbos": [], "luca": 4, "nesterenko": 4, "bastien": 4, "boussau": 4, "laurent": 4, "jacob": 4, "repositori": 4, "articl": 4, "nesterenko2022phyloform": 4, "author": 4, "titl": 4, "year": 4, "2022": 4, "doi": 4, "http": 4, "org": 4, "10": 4, "1101": 4, "24": 4, "496975": 4, "url": 4, "www": 4, "biorxiv": 4, "496975v1": 4, "journal": 4, "easiest": 4, "wai": 4, "softwar": 4, "i": [2, 4], "mamba": 4, "conda": 4, "c": 4, "forg": 4, "env": 4, "f": 4, "environ": 4, "yml": 4, "activ": 4, "phylo": 4, "To": 4, "check": 4, "success": 4, "can": 4, "python": 4, "py": 4, "testdata": 4, "print": 4, "mean": 4, "robinson": 4, "fould": 4, "equal": 4, "063": 4, "we": 4, "provid": 4, "tool": 4, "simpli": 4, "argument": 4, "multipl": 4, "protein": 4, "program": 4, "each": 4, "newick": [2, 4], "same": [2, 4], "wish": 4, "choos": 4, "differ": 4, "he": 4, "o": 4, "flag": 4, "By": 4, "pam": 4, "evolut": 4, "m": 4, "other": 4, "current": [2, 4], "avail": [2, 4], "being": 4, "final": 4, "nvidia": 4, "allow": 4, "exploit": 4, "offer": 4, "great": 4, "speed": 4, "up": 4, "evolv": 4, "along": 4, "gener": [2, 4], "nleav": 4, "leav": 4, "ntree": 4, "topologi": 4, "uniform": 4, "branch": 4, "lenght": 4, "distribut": 4, "support": 4, "sampl": 4, "uniformli": 4, "birth": 4, "death": 4, "process": [2, 4], "birth_rat": 4, "death_rat": 4, "5": [2, 4], "between": [2, 4], "002": 4, "exponenti": 4, "lambda": 4, "15": 4, "therefor": 4, "just": 4, "100000": 4, "nwk": 4, "sg": 4, "3": 4, "possibl": 4, "those": 4, "again": 4, "follow": [2, 4], "treedir": 4, "alidir": 4, "correspond": 4, "json": 4, "configur": [2, 4], "further": 4, "In": 4, "find": 4, "exampl": 4, "stdconfig": 4, "e": 4, "plmbox": 4, "math": 4, "cnr": 4, "fr": 4, "f5a2ed2667a841cba6f0": 4, "wag": 4, "834248a35ba64752a6a4": 4, "under": 4, "datadryad": 4, "stash": 4, "253a10": 4, "5061": 4, "252fdryad": 4, "rbnzs7h91": 4, "still": 4, "stage": 4, "proof": 4, "concept": 4, "particular": 4, "observ": 4, "lower": 4, "more": 4, "than": 4, "40": 4, "As": 4, "discuss": 4, "manuscript": 4, "like": 4, "fix": 4, "after": [2, 4], "re": 4, "larger": 4, "evolutionari": 4, "experi": 4, "report": 4, "were": 4, "popul": 4, "ete3": 4, "investig": 4, "reason": 4, "discrep": 4, "make": 4, "transpar": 4, "would": 4, "veri": 4, "interest": 4, "hear": 4, "about": 4, "case": 4, "underperform": 4, "load_tre": [1, 2], "pairwis": 2, "indic": 2, "which": 2, "leaf": 2, "_backward_hook": [], "_buffer": [], "_forward_hook": [], "_forward_pre_hook": [], "_is_full_backward_hook": [], "_load_state_dict_post_hook": [], "_load_state_dict_pre_hook": [], "_modul": [], "_non_persistent_buffers_set": [], "_paramet": [], "_state_dict_hook": [], "_parse_align": [], "_read_distances_from_tre": [], "_sequence_to_one_hot": [], "_init_seq2pair": [], "_init_model": [], "callabl": [], "set": [], "parser": [], "kei": [], "valu": [], "read": [], "dictionari": 2, "triangular": [], "ndarrai": [], "encod": [], "amino": [], "acid": [], "hot": [], "np": [], "initi": 2, "seq2pair": [], "filter": 2, "tensor_pair": 2, "pair": 2, "name": 2, "keep": 2, "transform": 2, "multi": 2, "droupout": 2, "cuda": 2, "intern": 2, "share": 2, "both": 2, "nn": 2, "scriptmodul": 2, "instanci": 2, "valid": 2, "tree_dir": 3, "save_checkpoint": [1, 2], "_init_optim": [], "_init_schedul": [], "algorithm": 2, "learning_r": 2, "adam": 2, "adamw": 2, "sgd": 2, "want": [], "appli": 2, "warmup": 2, "warmup_step": 2, "_lrschedul": 2, "dure": 2, "step": 2, "lr_schedul": [], "_init_loss": [], "loss": 2, "_loss": 2, "object": [], "l1": 2, "l2": 2, "05": 2, "choic": 2, "warmupt": 2, "_get_architectur": [], "ani": 2, "reducelronplateau": 2, "checkpoint": 2, "start": 2, "divis": 2, "train_data": 2, "dataload": 2, "val_data": 2, "epoch": 2, "80": 2, "clip_gradi": 2, "early_stop": 2, "stopping_step": 2, "8": 2, "best_path": 2, "checkpoint_path": 2, "log_fil": 2, "tensorboard_writ": 2, "automat": 2, "mix": 2, "precis": 2, "onli": 2, "clip": 2, "gradient": 2, "stop": 2, "trainig": 2, "earli": 2, "improv": 2, "how": 2, "mani": 2, "stesp": 2, "without": 2, "best": 2, "so": 2, "fat": 2, "last": 2, "log": 2, "metric": 2, "summarywrit": 2, "tensorboard": 2, "_description_": [], "init_logg": 3, "onto": 2, "log_opt": 3, "logfil": 3}, "objects": {"": [[2, 0, 0, "-", "phyloformer"]], "phyloformer": [[2, 0, 0, "-", "attentions"], [2, 0, 0, "-", "data"], [2, 0, 0, "-", "phyloformer"], [2, 0, 0, "-", "pretrained"], [3, 0, 0, "-", "scripts"], [2, 0, 0, "-", "training"]], "phyloformer.attentions": [[2, 1, 1, "", "KernelAxialMultiAttention"]], "phyloformer.attentions.KernelAxialMultiAttention": [[2, 2, 1, "", "forward"], [2, 3, 1, "", "training"]], "phyloformer.data": [[2, 1, 1, "", "TensorDataset"], [2, 4, 1, "", "load_alignment"], [2, 4, 1, "", "load_dataset"], [2, 4, 1, "", "load_tree"], [2, 4, 1, "", "write_dm"]], "phyloformer.phyloformer": [[2, 1, 1, "", "AttentionNet"], [2, 4, 1, "", "load_model"], [2, 4, 1, "", "load_state_dict"]], "phyloformer.phyloformer.AttentionNet": [[2, 2, 1, "", "forward"], [2, 2, 1, "", "infer_dm"], [2, 2, 1, "", "infer_tree"], [2, 2, 1, "", "save"], [2, 3, 1, "", "training"]], "phyloformer.pretrained": [[2, 4, 1, "", "evosimz"], [2, 4, 1, "", "seqgen"]], "phyloformer.scripts": [[3, 0, 0, "-", "evaluate"], [3, 0, 0, "-", "make_tensors"], [3, 0, 0, "-", "predict"], [3, 0, 0, "-", "simulateAlignments"], [3, 0, 0, "-", "simulateTrees"], [3, 0, 0, "-", "train"]], "phyloformer.scripts.evaluate": [[3, 4, 1, "", "evaluate"], [3, 4, 1, "", "main"]], "phyloformer.scripts.make_tensors": [[3, 4, 1, "", "main"], [3, 4, 1, "", "make_tensors"]], "phyloformer.scripts.predict": [[3, 4, 1, "", "is_fasta"], [3, 4, 1, "", "main"], [3, 4, 1, "", "make_predictions"]], "phyloformer.scripts.simulateAlignments": [[3, 4, 1, "", "main"], [3, 4, 1, "", "simulate_alignments"]], "phyloformer.scripts.simulateTrees": [[3, 4, 1, "", "main"], [3, 4, 1, "", "simulate_trees"]], "phyloformer.scripts.train": [[3, 4, 1, "", "init_loggers"], [3, 4, 1, "", "main"]], "phyloformer.training": [[2, 4, 1, "", "init_training"], [2, 4, 1, "", "load_checkpoint"], [2, 4, 1, "", "save_checkpoint"], [2, 4, 1, "", "training_loop"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:method", "3": "py:attribute", "4": "py:function"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "method", "Python method"], "3": ["py", "attribute", "Python attribute"], "4": ["py", "function", "Python function"]}, "titleterms": {"welcom": 0, "phyloform": [0, 2, 3, 4], "": 0, "document": 0, "content": [0, 2, 3], "indic": 0, "tabl": 0, "api": 1, "refer": 1, "packag": [2, 3], "subpackag": [], "submodul": [2, 3], "attent": [2, 4], "modul": [2, 3], "data": 2, "pretrain": 2, "train": [2, 3, 4], "script": 3, "evalu": 3, "make_tensor": 3, "predict": 3, "simulatealign": 3, "simulatetre": 3, "introduct": 4, "toward": 4, "fast": 4, "accur": 4, "phylogeni": 4, "estim": 4, "self": 4, "network": 4, "instal": 4, "test": 4, "run": 4, "usag": 4, "simul": 4, "tree": 4, "align": 4, "creat": 4, "tensor": 4, "dataset": 4, "model": 4, "reproduc": 4, "result": 4, "paper": 4, "disclaim": 4}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.viewcode": 1, "sphinx": 57}, "alltitles": {"Welcome to Phyloformer\u2019s documentation!": [[0, "welcome-to-phyloformer-s-documentation"]], "Contents:": [[0, null]], "Indices and tables": [[0, "indices-and-tables"]], "API reference": [[1, "api-reference"]], "Introduction to Phyloformer": [[4, "introduction-to-phyloformer"]], "Phyloformer: Towards fast and accurate Phylogeny estimation with self-attention Networks": [[4, "phyloformer-towards-fast-and-accurate-phylogeny-estimation-with-self-attention-networks"]], "Install": [[4, "install"]], "Test run": [[4, "test-run"]], "Usage": [[4, "usage"]], "Simulations and training": [[4, "simulations-and-training"]], "Simulating the trees": [[4, "simulating-the-trees"]], "Simulating the alignments": [[4, "simulating-the-alignments"]], "Creating a tensor dataset": [[4, "creating-a-tensor-dataset"]], "Training the model": [[4, "training-the-model"]], "Reproducibility of the results in the paper": [[4, "reproducibility-of-the-results-in-the-paper"]], "Disclaimer:": [[4, "disclaimer"]], "Submodules": [[3, "submodules"], [2, "submodules"]], "Module contents": [[3, "module-phyloformer.scripts"], [2, "module-phyloformer"]], "phyloformer.scripts package": [[3, "phyloformer-scripts-package"]], "phyloformer.scripts.evaluate module": [[3, "module-phyloformer.scripts.evaluate"]], "phyloformer.scripts.make_tensors module": [[3, "module-phyloformer.scripts.make_tensors"]], "phyloformer.scripts.predict module": [[3, "module-phyloformer.scripts.predict"]], "phyloformer.scripts.simulateAlignments module": [[3, "module-phyloformer.scripts.simulateAlignments"]], "phyloformer.scripts.simulateTrees module": [[3, "module-phyloformer.scripts.simulateTrees"]], "phyloformer.scripts.train module": [[3, "module-phyloformer.scripts.train"]], "phyloformer package": [[2, "phyloformer-package"]], "phyloformer.attentions module": [[2, "module-phyloformer.attentions"]], "phyloformer.data module": [[2, "module-phyloformer.data"]], "phyloformer.phyloformer module": [[2, "module-phyloformer.phyloformer"]], "phyloformer.pretrained module": [[2, "module-phyloformer.pretrained"]], "phyloformer.training module": [[2, "module-phyloformer.training"]]}, "indexentries": {"attentionnet (class in phyloformer.phyloformer)": [[2, "phyloformer.phyloformer.AttentionNet"]], "kernelaxialmultiattention (class in phyloformer.attentions)": [[2, "phyloformer.attentions.KernelAxialMultiAttention"]], "tensordataset (class in phyloformer.data)": [[2, "phyloformer.data.TensorDataset"]], "evosimz() (in module phyloformer.pretrained)": [[2, "phyloformer.pretrained.evosimz"]], "forward() (phyloformer.attentions.kernelaxialmultiattention method)": [[2, "phyloformer.attentions.KernelAxialMultiAttention.forward"]], "forward() (phyloformer.phyloformer.attentionnet method)": [[2, "phyloformer.phyloformer.AttentionNet.forward"]], "infer_dm() (phyloformer.phyloformer.attentionnet method)": [[2, "phyloformer.phyloformer.AttentionNet.infer_dm"]], "infer_tree() (phyloformer.phyloformer.attentionnet method)": [[2, "phyloformer.phyloformer.AttentionNet.infer_tree"]], "init_training() (in module phyloformer.training)": [[2, "phyloformer.training.init_training"]], "load_alignment() (in module phyloformer.data)": [[2, "phyloformer.data.load_alignment"]], "load_checkpoint() (in module phyloformer.training)": [[2, "phyloformer.training.load_checkpoint"]], "load_dataset() (in module phyloformer.data)": [[2, "phyloformer.data.load_dataset"]], "load_model() (in module phyloformer.phyloformer)": [[2, "phyloformer.phyloformer.load_model"]], "load_state_dict() (in module phyloformer.phyloformer)": [[2, "phyloformer.phyloformer.load_state_dict"]], "load_tree() (in module phyloformer.data)": [[2, "phyloformer.data.load_tree"]], "module": [[2, "module-phyloformer"], [2, "module-phyloformer.attentions"], [2, "module-phyloformer.data"], [2, "module-phyloformer.phyloformer"], [2, "module-phyloformer.pretrained"], [2, "module-phyloformer.training"]], "phyloformer": [[2, "module-phyloformer"]], "phyloformer.attentions": [[2, "module-phyloformer.attentions"]], "phyloformer.data": [[2, "module-phyloformer.data"]], "phyloformer.phyloformer": [[2, "module-phyloformer.phyloformer"]], "phyloformer.pretrained": [[2, "module-phyloformer.pretrained"]], "phyloformer.training": [[2, "module-phyloformer.training"]], "save() (phyloformer.phyloformer.attentionnet method)": [[2, "phyloformer.phyloformer.AttentionNet.save"]], "save_checkpoint() (in module phyloformer.training)": [[2, "phyloformer.training.save_checkpoint"]], "seqgen() (in module phyloformer.pretrained)": [[2, "phyloformer.pretrained.seqgen"]], "training (phyloformer.attentions.kernelaxialmultiattention attribute)": [[2, "phyloformer.attentions.KernelAxialMultiAttention.training"]], "training (phyloformer.phyloformer.attentionnet attribute)": [[2, "phyloformer.phyloformer.AttentionNet.training"]], "training_loop() (in module phyloformer.training)": [[2, "phyloformer.training.training_loop"]], "write_dm() (in module phyloformer.data)": [[2, "phyloformer.data.write_dm"]]}})